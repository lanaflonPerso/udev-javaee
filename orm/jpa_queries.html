
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Les requêtes JPA &#8212; documentation Java EE 1.0</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="les-requetes-jpa">
<h1>Les requêtes JPA<a class="headerlink" href="#les-requetes-jpa" title="Lien permanent vers ce titre">¶</a></h1>
<p>Les méthodes <code class="docutils literal"><span class="pre">find</span></code>, <code class="docutils literal"><span class="pre">persist</span></code>, <code class="docutils literal"><span class="pre">merge</span></code>, <code class="docutils literal"><span class="pre">detach</span></code>, <code class="docutils literal"><span class="pre">refresh</span></code>
et <code class="docutils literal"><span class="pre">remove</span></code> disponibles avec une instance d’un <a class="reference external" href="https://docs.oracle.com/javaee/7/api/javax/persistence/EntityManager.html">EntityManager</a>
permettent de gérer simplement une entité mais ne permettent pas de
réaliser des requêtes très élaborées.</p>
<p>Heureusement, un <a class="reference external" href="https://docs.oracle.com/javaee/7/api/javax/persistence/EntityManager.html">EntityManager</a> fournit également différentes API
pour exécuter des requêtes. Le principe est toujours le même&nbsp;:</p>
<ol class="arabic simple">
<li>On crée un objet de type <a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/persistence/Query.html">Query</a> ou <a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/persistence/TypedQuery.html">TypedQuery</a> grâce à l’API</li>
<li>Pour les requêtes paramétrées, on positionne la valeur des paramètres
grâce aux méthodes <code class="docutils literal"><span class="pre">setParameter(String</span> <span class="pre">name,</span> <span class="pre">XXX</span> <span class="pre">xxx)</span></code> ou
<code class="docutils literal"><span class="pre">setParameter(int</span> <span class="pre">position,</span> <span class="pre">XXX</span> <span class="pre">xxx)</span></code></li>
<li>On peut optionnellement positionner plusieurs autres informations
pour la requête (par exemple, le nombre maximum de résultats pour une
consultation grâce à la méthode <code class="docutils literal"><span class="pre">setMaxResults(int)</span></code>)</li>
<li>On exécute la requête grâce aux méthodes <code class="docutils literal"><span class="pre">executeUpdate()</span></code> (pour un
update ou un delete), <code class="docutils literal"><span class="pre">getSingleResult()</span></code> (pour une requête SELECT
ne retournant qu’un seul résultat) ou <code class="docutils literal"><span class="pre">getResultList()</span></code> (pour une
requête SELECT retournant une liste de résultats).</li>
</ol>
<p>Pour les différents exemples de requêtes qui suivent, nous nous baserons
sur l’entité JPA suivante&nbsp;:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.persistence.Basic</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.Column</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.GeneratedValue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.GenerationType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.Id</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.Table</span><span class="o">;</span>

<span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;individu&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Individu</span> <span class="o">{</span>
  <span class="nd">@Id</span>
  <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;individuId&quot;</span><span class="o">)</span>
  <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="n">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>

  <span class="nd">@Basic</span>
  <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">30</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">nom</span><span class="o">;</span>

  <span class="nd">@Basic</span>
  <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">30</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">prenom</span><span class="o">;</span>

  <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">3</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>

  <span class="c1">// les getters et setters sont omis ...</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Cette entité JPA correspond à la table MySQL&nbsp;:</p>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">individu</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">individuId</span><span class="o">`</span> <span class="nb">int</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
  <span class="o">`</span><span class="n">nom</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">prenom</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">age</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">individu_id</span><span class="o">`</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="section" id="les-requetes-natives">
<h2>Les requêtes Natives<a class="headerlink" href="#les-requetes-natives" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les requêtes natives en JPA désignent les requêtes SQL. On crée une
requête native à partir des méthodes
<code class="docutils literal"><span class="pre">EntityManager.createNativeQuery(...)</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: récupérer tous les individus</span><a class="headerlink" href="#id1" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">individus</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="n">individus</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">createNativeQuery</span><span class="o">(</span><span class="s">&quot;select * from individu&quot;</span><span class="o">,</span> <span class="n">Individu</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                         <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: récupérer tous les individus âgés au plus de ageMax</span><a class="headerlink" href="#id2" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">ageMax</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">individus</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="n">individus</span> <span class="o">=</span> <span class="n">entityManager</span>
              <span class="o">.</span><span class="na">createNativeQuery</span><span class="o">(</span><span class="s">&quot;select * from individu where age &lt;= ?&quot;</span><span class="o">,</span> <span class="n">Individu</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
              <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">ageMax</span><span class="o">)</span>
              <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: connaître le nombre d’individus enregistrés</span><a class="headerlink" href="#id3" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="o">(</span><span class="n">Long</span><span class="o">)</span> <span class="n">entityManager</span>
                   <span class="o">.</span><span class="na">createNativeQuery</span><span class="o">(</span><span class="s">&quot;select count(1) from individu&quot;</span><span class="o">)</span>
                   <span class="o">.</span><span class="na">getSingleResult</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: Suppression d’un individu dont l’id est individuId</span><a class="headerlink" href="#id4" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kt">long</span> <span class="n">individuId</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
<span class="c1">// Cette requête nécessite une transaction active</span>
<span class="n">entityManager</span><span class="o">.</span><span class="na">createNativeQuery</span><span class="o">(</span><span class="s">&quot;delete from individu where individuId = ?&quot;</span><span class="o">)</span>
             <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">individuId</span><span class="o">)</span>
             <span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="les-requetes-jpql">
<h2>Les requêtes JPQL<a class="headerlink" href="#les-requetes-jpql" title="Lien permanent vers ce titre">¶</a></h2>
<p>Avec JPA, il est possible d’utiliser une autre langage pour l’écriture
des requêtes, il s’agit du <strong>JPA Query Language</strong> (JPQL). Ce langage est
un langage de requête objet. L’objectif n’est plus d’écrire des requêtes
basées sur le modèle relationnel des tables mais sur le modèle objet des
classes Java.</p>
<p>Pour une <strong>introduction à la syntaxe du JPQL</strong>, reportez-vous au
<a class="reference external" href="http://en.wikibooks.org/wiki/Java_Persistence/JPQL">Wikibook</a>.</p>
<p>On crée une requête JPQL à partir des méthodes <code class="docutils literal"><span class="pre">EntityManager.createQuery(...)</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: récupérer tous les individus</span><a class="headerlink" href="#id5" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">individus</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="n">individus</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">&quot;select i from Individu i&quot;</span><span class="o">,</span> <span class="n">Individu</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                         <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: récupérer tous les individus âgés au plus de ageMax</span><a class="headerlink" href="#id6" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">ageMax</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">individus</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="n">individus</span> <span class="o">=</span> <span class="n">entityManager</span>
                <span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">&quot;select i from Individu i where i.age &lt;= :ageMax&quot;</span><span class="o">,</span> <span class="n">Individu</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">&quot;ageMax&quot;</span><span class="o">,</span> <span class="n">ageMax</span><span class="o">)</span>
                <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: connaître le nombre d’individus enregistrés</span><a class="headerlink" href="#id7" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="o">(</span><span class="n">Long</span><span class="o">)</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">&quot;select count(i) from Individu i&quot;</span><span class="o">)</span>
                           <span class="o">.</span><span class="na">getSingleResult</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: Suppression d’un individu dont l’id est individuId</span><a class="headerlink" href="#id8" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kt">long</span> <span class="n">individuId</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
<span class="c1">// Cette requête nécessite une transaction active</span>
<span class="n">entityManager</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">&quot;delete from Individu i where i.id = :id&quot;</span><span class="o">)</span>
             <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">,</span> <span class="n">individuId</span><span class="o">)</span>
             <span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
</pre></div>
</div>
</div>
<p>Sur des exemples aussi simples que les exemples précédents, le JPQL
semble très proche du SQL. Cependant, avec le JPQL, on ne fait référence
qu’aux objets et à leurs attributs, <strong>jamais</strong> au nom des tables et des
colonnes.</p>
<p>Ainsi, dans la requête JPQL suivante&nbsp;:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">individu</span> <span class="n">from</span> <span class="n">Individu</span> <span class="n">individu</span>
</pre></div>
</div>
<p><strong>individu</strong> désigne la variable contenant l’instance courante de la
classe Individu. Il ne s’agit absolument pas d’un alias de table comme
en SQL. La déclaration d’une variable en JPQL est obligatoire&nbsp;! Alors
qu’un alias de table SQL est optionnel.</p>
<p>Enfin, le JPQL introduit une nouvelle façon de déclarer un paramètre
dans une requête sous la forme <code class="docutils literal"><span class="pre">:nom</span></code>. Les paramètres disposent
ainsi d’un nom explicite, rendant ainsi le code plus facile à lire et à
maintenir.</p>
<div class="section" id="les-requetes-par-programmation">
<h3>Les requêtes par programmation<a class="headerlink" href="#les-requetes-par-programmation" title="Lien permanent vers ce titre">¶</a></h3>
<p>Lorsque l’on souhaite construire une requête JPQL dynamiquement, il
n’est pas toujours très facile de construire la requête par simple
concaténation de chaînes de caractères. Pour cela, JPA fournit une API
permettant de définir entièrement une requête JPQL par programmation. On
crée cette requête à travers un <a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/persistence/criteria/CriteriaBuilder.html">CriteriaBuilder</a> que l’on peut récupérer grâce
à la méthode <code class="docutils literal"><span class="pre">EntityManager.getCriteriaBuilder()</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: récupérer tous les individus</span><a class="headerlink" href="#id9" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">CriteriaBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">getCriteriaBuilder</span><span class="o">();</span>

<span class="n">CriteriaQuery</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">Individu</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">Root</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">Individu</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">query</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">individus</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">query</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: récupérer tous les individus âgés au plus de ageMax</span><a class="headerlink" href="#id10" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">ageMax</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>

<span class="n">CriteriaBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">getCriteriaBuilder</span><span class="o">();</span>

<span class="n">CriteriaQuery</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">Individu</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">Root</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">Individu</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">query</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
<span class="n">query</span><span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">builder</span><span class="o">.</span><span class="na">lessThanOrEqualTo</span><span class="o">(</span><span class="n">i</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;age&quot;</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="kt">int</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">ageMax</span><span class="o">));</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">individus</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">query</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">Exemple&nbsp;: connaître le nombre d’individus enregistrés</span><a class="headerlink" href="#id11" title="Lien permanent vers ce code">¶</a></div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">CriteriaBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">getCriteriaBuilder</span><span class="o">();</span>

<span class="n">CriteriaQuery</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">Long</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">Root</span><span class="o">&lt;</span><span class="n">Individu</span><span class="o">&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">Individu</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">query</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">builder</span><span class="o">.</span><span class="na">count</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>

<span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">query</span><span class="o">).</span><span class="na">getSingleResult</span><span class="o">();</span>
</pre></div>
</div>
</div>
<p>Pour des exemples supplémentaires d’utilisation du <a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/persistence/criteria/CriteriaBuilder.html">CriteriaBuilder</a>,
reportez-vous au <a class="reference external" href="http://en.wikibooks.org/wiki/Java_Persistence/Criteria">Wikibook</a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Java EE</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../environnement_developpement.html">L’environnement de développement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../premiere_application.html">Une première application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maven.html">Introduction à Maven</a></li>
<li class="toctree-l1"><a class="reference internal" href="../servlet.html">Les Servlets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conteneur_web.html">Le conteneur Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../attributs_web.html">Les attributs d’une application Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jsp.html">JSP : Java Server Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../request_dispatcher.html">RequestDispatcher et MVC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_listeners_filters.html">Web listeners et filtres</a></li>
<li class="toctree-l1"><a class="reference internal" href="jdbc_webapp.html">JDBC dans une application Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="ejb.html">Les EJB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jsf.html">Java Server Faces (JSF)</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://docs.oracle.com/javase/8/docs/api/index.html?overview-summary.html">API Java</a></li>
    
    <li class="toctree-l1"><a href="https://docs.oracle.com/javaee/7/api/">API Java EE</a></li>
    
    <li class="toctree-l1"><a href="http://docs.oracle.com/javase/8/docs/">Documentation Java</a></li>
    
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;
<a ref="author" href="mailto:dagaydevel@free.fr">David Gayerie</a>
<a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/fr/"><img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/fr/80x15.png" /></a>
.
      
    </div>

    

    
  </body>
</html>